<!DOCTYPE html>
<html lang="lo">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∫à‡ªà‡∫≤‡∫ç‡ªÄ‡∫á‡∫¥‡∫ô - ‡ªÄ‡∫ï‡∫µ‡∫°‡ªÄ‡∫ô‡∫±‡∫î‡∫°‡∫∑‡∫ñ‡∫∑</title>
    <link rel="stylesheet" href="payment.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Lao&display=swap');

        body {
            font-family: 'Noto Sans Lao', sans-serif;
        }
    </style>
</head>
<body>

    <div class="payment-container">
        <h2>‡∫™‡∫∞‡ªÅ‡∫Å‡∫ô‡ªÄ‡∫û‡∫∑‡ªà‡∫≠‡∫à‡ªà‡∫≤‡∫ç‡ªÄ‡∫á‡∫¥‡∫ô</h2>

        <p><strong>‡ªù‡∫≤‡∫ç‡ªÄ‡∫•‡∫Å‡∫≠‡ªç‡ªÄ‡∫î‡∫µ:</strong> <span id="orderId"></span></p>
        <p><strong>‡ªÄ‡∫ö‡∫µ‡ªÇ‡∫ó‡∫•‡∫∞‡∫™‡∫±‡∫ö:</strong> <span id="phoneNumber">-</span></p>
        <p><strong>‡ªÅ‡∫û‡∫±‡∫Å‡ªÄ‡∫Å‡∫±‡∫î‡∫ó‡∫µ‡ªà‡∫™‡∫±‡ªà‡∫á‡∫ä‡∫∑‡ªâ:</strong> <span id="packageDetails">-</span></p>
        <p><strong>‡∫ß‡∫±‡∫ô‡∫ó‡∫µ‡ªÄ‡∫Æ‡∫±‡∫î‡∫ó‡∫∏‡∫•‡∫∞‡∫Å‡ªç‡∫≤:</strong> <span id="transactionDate"></span></p>

        <label for="network">‡ªÄ‡∫•‡∫∑‡∫≠‡∫Å‡∫ä‡ªà‡∫≠‡∫á‡∫ó‡∫≤‡∫á‡∫Å‡∫≤‡∫ô‡∫à‡ªà‡∫≤‡∫ç‡ªÄ‡∫á‡∫¥‡∫ô:</label>
        <select id="network" onchange="updateQRCode()">
            <option value="bcel">BCEL</option>
            <option value="ldb">LDB</option>
        </select>

        <div class="qr-container">
            <img id="qrCode" src="bcel_qr.png" alt="QR Code">
        </div>

        <button id="payBtn">‡∫¢‡∫∑‡∫ô‡∫¢‡∫±‡∫ô‡∫Å‡∫≤‡∫ô‡∫à‡ªà‡∫≤‡∫ç‡ªÄ‡∫á‡∫¥‡∫ô</button>
    </div>

    <script>
        // ‡∫ü‡∫±‡∫á‡∫ä‡∫±‡∫ô‡∫î‡∫∂‡∫á‡∫Ñ‡ªà‡∫≤‡∫à‡∫≤‡∫Å URL
        function getQueryParam(param) {
            let urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param) || "‡∫ö‡ªç‡ªà‡∫û‡∫ª‡∫ö‡∫Ç‡ªç‡ªâ‡∫°‡∫π‡∫ô";
        }

        // ‡∫Å‡∫≥‡∫ô‡∫ª‡∫î‡∫Ç‡ªç‡ªâ‡∫°‡∫π‡∫ô‡∫à‡∫≤‡∫Å URL ‡ªÑ‡∫õ‡∫ç‡∫±‡∫á‡ªú‡ªâ‡∫≤‡ªÄ‡∫ß‡∫±‡∫ö
        document.addEventListener("DOMContentLoaded", function() {
            document.getElementById("phoneNumber").textContent = getQueryParam("phone");
            document.getElementById("packageDetails").textContent = getQueryParam("package");
            document.getElementById("orderId").textContent = Math.floor(Math.random() * 1000000);
            document.getElementById("transactionDate").textContent = new Date().toLocaleString("lo-LA");
        });

        // ‡∫ü‡∫±‡∫á‡∫ä‡∫±‡∫ô‡∫≠‡∫±‡∫ö‡ªÄ‡∫î‡∫î QR Code ‡∫ï‡∫≤‡∫°‡∫ó‡∫∞‡∫ô‡∫≤‡∫Ñ‡∫≤‡∫ô‡∫ó‡∫µ‡ªà‡ªÄ‡∫•‡∫∑‡∫≠‡∫Å
        function updateQRCode() {
            let selectedBank = document.getElementById("network").value;
            document.getElementById("qrCode").src = selectedBank === "bcel" ? "bcel_qr.png" : "ldb_qr.png";
        }

        // ‡∫Å‡∫ß‡∫î‡∫™‡∫≠‡∫ö‡∫Å‡∫≤‡∫ô Screenshot
        let screenshotTaken = false;
        document.addEventListener("visibilitychange", function() {
            if (document.hidden) {
                screenshotTaken = true;
            }
        });

        // ‡∫õ‡∫∏‡ªà‡∫°‡∫¢‡∫∑‡∫ô‡∫¢‡∫±‡∫ô‡∫Å‡∫≤‡∫ô‡∫à‡ªà‡∫≤‡∫ç‡ªÄ‡∫á‡∫¥‡∫ô
        document.getElementById("payBtn").addEventListener("click", function() {
            if (!screenshotTaken) {
                alert("üò§‡∫ó‡ªà‡∫≤‡∫ô‡∫ç‡∫±‡∫á‡∫ö‡ªç‡ªà‡ªÑ‡∫î‡ªâ‡∫ä‡∫≥‡∫•‡∫∞üò§(‡∫Å‡∫∞‡∫•‡∫∏‡∫ô‡∫≤‡∫™‡∫∞‡ªÅ‡∫Å‡∫ô‡ªÄ‡∫û‡∫∑‡ªà‡∫≠‡∫ä‡∫∑‡ªâ‡ªÅ‡∫û‡∫±‡∫Å‡ªÄ‡∫Å‡∫±‡∫î)"); 
            } else {
                // ‡∫™‡∫ª‡ªà‡∫á‡ªÑ‡∫õ‡∫´‡∫≤‡ªú‡ªâ‡∫≤ bill.html ‡∫û‡ªâ‡∫≠‡∫°‡∫Ç‡ªç‡ªâ‡∫°‡∫π‡∫ô
                let billUrl = `bill.html?phone=${encodeURIComponent(getQueryParam("phone"))}&package=${encodeURIComponent(getQueryParam("package"))}&orderId=${document.getElementById("orderId").textContent}&transactionDate=${encodeURIComponent(document.getElementById("transactionDate").textContent)}`;
                window.location.href = billUrl;
            }
        });
    </script>

</body>
</html>